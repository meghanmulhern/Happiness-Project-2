
<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
  </head>
  <body>
    <div id="regions_div" style="width: 900px; height: 500px;"></div>
    <script type="text/javascript">
      google.charts.load('current', {
        'packages':['geochart'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
        'mapsApiKey': 'AIzaSyDHdelbQAEdfZwnzbCWzu3nQaW2ZO2pBrI'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);

      function drawRegionsMap() {
        d3.json("http://127.0.0.1:5000//api/v1.0/happiness").then(function(happiness_data){
          var happy_year = happiness_data.filter(x => x.year == 2020).map(x => {
            return [x.country, x.happiness_score]
          })
          happy_year.unshift(["country", "happiness_score"])
          var data = google.visualization.arrayToDataTable(happy_year)
          var options = {};
          var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));
          chart.draw(data, options);
        })
        // var data = google.visualization.arrayToDataTable([
        //   ['Country', 'Popularity'],
        //   ['Germany', 200],
        //   ['United States', 300],
        //   ['Brazil', 400],
        //   ['Canada', 500],
        //   ['France', 600],
        //   ['RU', 700]
        // ]);


      }
    </script>
  </body>
</html>
